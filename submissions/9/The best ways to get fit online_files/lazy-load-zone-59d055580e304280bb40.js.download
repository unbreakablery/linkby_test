(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["lazy-load-zone"],{"./src/ts/components/lazy-load-zone/lazy-load-zone.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{lazyLoadZoneComponent:()=>s,init:()=>d});var o=n("../shared-types/frontend/core/store.ts"),a=n("./src/ts/utils/request.ts"),r=n("./src/ts/utils/scripts.ts");const s=(e,t)=>{let n=0,s=2;const d={async fetchZoneContent(e){const t=e.url.replace(":pageNumber",""+s);return await(0,a.A_)({url:t,responseType:"text"})},async fetchZoneContentAndUpdate(e){d.fetchZoneContent(e).then(n=>{if(n)return t.dispatch({type:o.U.ZoneLoaded,payload:{zoneId:e.zoneId}}),d.updateZoneDataContent(n,e);t.dispatch({type:o.U.ZoneLoadingEnded,payload:{zoneId:e.zoneId}})}).then(()=>++s).catch(n=>{t.dispatch({type:o.U.ZoneLoadingError,payload:{zoneId:e.zoneId,timestamp:Date.now(),error:{message:null==n?void 0:n.message}}})})},getRootElementParams(){if(e.dataset.params)try{return JSON.parse(e.dataset.params)}catch(e){return}},init(){const e=d.getRootElementParams();return e?(t.subscribe(()=>{const o=t.getState().lazyZones[e.zoneId];"LOADING"===(null==o?void 0:o.status)&&n!==(null==o?void 0:o.timestamp)&&(n=o.timestamp,d.fetchZoneContentAndUpdate(e))}),{}):{}},updateZoneDataContent(n,a){const s=document.createElement("div");s.insertAdjacentHTML("beforeend",n);const d=s.querySelector(".zoneItems"),c=e.querySelector(".zoneItems");if(d&&c){c.insertAdjacentHTML("beforeend",d.innerHTML),s.querySelector('[data-component="infinite-scroll"]')||t.dispatch({type:o.U.ZoneLoadingEnded,payload:{zoneId:a.zoneId}}),(0,r.Ct)(c)}}};return d},d=(e,t)=>{const n=Math.floor(1e4*Math.random());return{listeners:s(e,t).init(),componentId:"lazy-load-zone-"+n}}},"./src/ts/utils/scripts.ts":(e,t,n)=>{"use strict";n.d(t,{ve:()=>o,BP:()=>a,Ct:()=>r});const o=async(e,t)=>new Promise((n,o)=>{const a=document.createElement("script");a.src=e,a.defer=!1,a.async=!0,a.type="text/javascript",a.onerror=o,a.onload=t||(()=>{n()}),document.getElementsByTagName("head")[0].appendChild(a)}),a=(e,t)=>{e.push=n=>{try{return t(n),Array.prototype.push.call(e,n)}catch(t){return e.length}}},r=e=>{[...e.querySelectorAll("script")].forEach(e=>{const t=document.createElement("script");[...e.attributes].forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(e.innerHTML)),e.parentNode.replaceChild(t,e)})}}}]);