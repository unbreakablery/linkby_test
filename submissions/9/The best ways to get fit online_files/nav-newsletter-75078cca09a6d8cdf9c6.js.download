(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["nav-newsletter"],{"./src/ts/components/nav-newsletter/nav-newsletter.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{navNewsletterComponent:()=>i,init:()=>c});var s=n("../react-components/dist/components/global/header/masthead/nav-newsletter/newsletter-cta/newsletter-cta.css.json"),r=n("../react-components/dist/components/global/header/masthead/nav-newsletter/subscription-form/subscription-form.css.json"),o=n("./src/ts/utils/crm.ts");const i=()=>{const e={subscribe:(t,n)=>{const s=n.subscribe(()=>{const r=n.getState();t.submitButton.disabled=!1,r.crm.receive?(s(),e.subscriptionSuccess(t,r.crm.receive.type)):r.crm.error&&e.subscriptionError(t)})},afterStart:(t,n)=>{var s,r,o;const i=e.subscriptionRequest(t,n);return null===(s=t.form)||void 0===s||s.addEventListener("submit",i),null===(r=t.closeButton)||void 0===r||r.addEventListener("click",()=>{t.closeInput&&(t.closeInput.checked=!1,t.closeInput.dispatchEvent(new Event("change")))}),null===(o=t.closeInput)||void 0===o||o.addEventListener("change",()=>{document.querySelector("body").classList.toggle("screen-lock",t.closeInput.checked)}),e.subscribe(t,n),i},subscriptionSuccess:(e,t)=>{var n,s,r;null===(n=e.submitButton)||void 0===n||n.removeAttribute("disabled"),null===(s=e.formContainer)||void 0===s||s.remove(),null===(r=e.success)||void 0===r||r.removeAttribute("hidden"),"nav"===t&&(0,o.W)(t)},subscriptionError:e=>{var t;null===(t=e.submitButton)||void 0===t||t.removeAttribute("disabled"),e.error.removeAttribute("hidden")},subscriptionRequest:(e,t)=>n=>{var s;n.preventDefault(),e.submitButton.disabled=!0,(0,o.C)(t,{email:null===(s=e.emailInput)||void 0===s?void 0:s.value,element:"newsletter-nav",referrer:window.location.href})},bindEvents:(t,n)=>{const o=(e=>({error:e.querySelector("."+r.vU),formContainer:e.querySelector(`.${r.kQ} > div`),success:e.querySelector("[data-nav-newsletter-success-container]"),form:e.querySelector("form"),emailInput:e.querySelector("."+r.mW),submitButton:e.querySelector("."+r.Ps),closeButton:e.querySelector("."+r.xv),closeInput:e.querySelector("."+s.bo)}))(t);return{subscriptionRequestListener:e.afterStart(o,n)}}};return e},c=(e,t)=>{const n=Math.floor(1e4*Math.random());return{listeners:i().bindEvents(e,t),componentId:"nav-newsletter-"+n}}},"./src/ts/config/config.ts":(e,t,n)=>{"use strict";n.d(t,{p:()=>o,u:()=>i});var s=n("./src/ts/utils/config-utils.ts");let r={};const o=()=>{const e=(0,s.P)(),t=e.site||"uk-london",[n,o]=t.split("-"),i=e.locale||"en-GB",c=e.currency_symbol||"Â£",a=e.current_commit||null,l=e.graffiti||null,u=e.discover||null,d=e.auth||null,p=e.pageUID||null;return r={...r,site:t,city:o,country:n,locale:i,currencySymbol:c,currentCommit:a,graffiti:l,discover:u,auth:d,pageUid:p},r},i=e=>{var t;return null!==(t=r[e])&&void 0!==t?t:null}},"./src/ts/core/client.ts":(e,t,n)=>{"use strict";n.d(t,{uj:()=>c,Ef:()=>l,iu:()=>u});var s=n("../shared-types/frontend/core/store.ts"),r=n("./src/ts/config/settings.ts");let o,i=!1;const c=()=>window.innerWidth>=window.innerHeight?"landscape":"portrait",a=e=>{const{client:{breakpoint:t}}=e.getState(),n=(({width:e,currentBreakpoint:t,breakpoints:n=r.aj})=>(Object.entries(n).some(([n,{min_width:s,max_width:r}])=>{const o={min:!1,max:!1};return(e>=s||0===s)&&(o.min=!0),(e<=r||0===r)&&(o.max=!0),!(!o.min||!o.max||n===t)&&(t=n,!0)}),t))({width:window.innerWidth,currentBreakpoint:t});t!==n&&e.dispatch({type:s.U.ClientBreakpoint,payload:{breakpoint:n}})},l=()=>{if(i)return;const e=window.gpStore;o=e,(e=>{const t=()=>{a(e)};window.matchMedia(`(min-width: ${r.aj.sm.min_width}px)`).addListener(t),window.matchMedia(`(min-width: ${r.aj.md.min_width}px)`).addListener(t),window.matchMedia(`(min-width: ${r.aj.lg.min_width}px)`).addListener(t)})(e),(e=>{a(e)})(e),i=!0},u=()=>o.getState().client.breakpoint},"./src/ts/utils/config-utils.ts":(e,t,n)=>{"use strict";n.d(t,{P:()=>s,R:()=>r});const s=()=>{const e={};return document.querySelectorAll("meta").forEach(t=>{const n=t.name?t.name:t.getAttribute("property")||!1;n&&(e[n]=t.content?t.content:t.dataset)}),e},r=(e=document)=>e.querySelector("body").dataset.pageType},"./src/ts/utils/crm.ts":(e,t,n)=>{"use strict";n.d(t,{C:()=>d,W:()=>b});var s=n("../shared-types/frontend/components/newsletter/subscription-status.ts"),r=n("../shared-types/frontend/core/store.ts"),o=n("../../node_modules/js-cookie/src/js.cookie.js"),i=n.n(o),c=n("./src/ts/config/config.ts"),a=n("./src/ts/core/client.ts"),l=n("./src/ts/core/omniture/omniture-utils.ts"),u=n("./src/ts/utils/request.ts");const d=async(e,t)=>m(e,w(e,t)),p={"newsletter-footer":"footer","newsletter-popup":"popup","newsletter-nav":"nav","newsletter-popup-gate":"popup-gate","newsletter-inline":"inline","newsletter-lander":"lander"},m=async(e,t)=>{try{const n=await(0,u.j0)({url:(0,c.u)("auth"),headers:{"Content-Type":"application/json"},data:t});return i().set(s.y.SignedUp,""+Date.now(),{expires:365}),e.dispatch({type:r.U.CRMReceive,payload:{...n,type:p[t.element]}}),n}catch(t){e.dispatch({type:r.U.CRMError,payload:{message:t.message,timestamp:Date.now()}})}},w=(e,{email:t,referrer:n,element:s,copyVersion:o="0001"})=>{const i=`s=GP&p=${s}&d=${(0,a.iu)()}&u=${(0,l.WX)()}&c=${o}`,u={email:t,site:(0,c.u)("site"),locale:(0,c.u)("locale"),platform:i,element:s,referrer:n};return e.dispatch({type:r.U.CRMSend,payload:u}),u},v={footer:"Newsletter Footer Success","list-feature":"Newsletter Inline Success",nav:"Newsletter Header Success",popup:"Newsletter Popup Success","popup-gate":"Newsletter Gate Success",inline:"Newsletter Inline Success",lander:"Newsletter Lander Success"},b=(e="")=>{var t,n;if(!(null===(n=null===(t=window.PARSELY)||void 0===t?void 0:t.conversions)||void 0===n?void 0:n.trackNewsletterSignup))return!1;const s=v[e];return!!s&&(window.PARSELY.conversions.trackNewsletterSignup(s),!0)}},"./src/ts/utils/inview.ts":(e,t,n)=>{"use strict";n.d(t,{oe:()=>s,oO:()=>r,W0:()=>o});const s=e=>{if(!e)return!1;const t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,s=window.innerWidth||document.documentElement.clientWidth,r=t.top<=n&&t.top+t.height>=0,o=t.left<=s&&t.left+t.width>=0;return r&&o};function r({element:e,observerOptions:t={},isInViewportCallback:n,isNotInViewportCallback:s}){new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&n&&(s||t.unobserve(e.target),n(e)),!e.isIntersecting&&s&&(n||t.unobserve(e.target),s(e))})},t).observe(e)}function o(e,t){return e?new Promise(n=>{r({element:e,observerOptions:t,isInViewportCallback:n})}):Promise.reject()}},"../shared-types/frontend/components/newsletter/subscription-status.ts":(e,t,n)=>{"use strict";var s;n.d(t,{y:()=>s}),function(e){e.SignedUp="_TO_Newsletter_SignedUp",e.Dismissed="_TO_Newsletter_Dismissed",e.PageViewCount="_TO_Newsletter_PageViewCount"}(s||(s={}))},"../react-components/dist/components/global/header/masthead/nav-newsletter/newsletter-cta/newsletter-cta.css.json":e=>{"use strict";e.exports=JSON.parse('{"bo":"_checkboxNav_1n32g_15"}')},"../react-components/dist/components/global/header/masthead/nav-newsletter/subscription-form/subscription-form.css.json":e=>{"use strict";e.exports=JSON.parse('{"kQ":"_content_12c49_1","vU":"_error_12c49_13","xv":"_close_12c49_76","mW":"_inputEmail_12c49_128","Ps":"_submit_12c49_144"}')}}]);