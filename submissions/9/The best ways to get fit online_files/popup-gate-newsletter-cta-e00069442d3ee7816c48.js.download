(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["popup-gate-newsletter-cta"],{"./src/ts/components/popup-gate-newsletter/popup-gate-newsletter-cta.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{isSignedUp:()=>c,show:()=>a,popupGateNewsletterCtaComponent:()=>d,init:()=>u});var s=n("../shared-types/frontend/components/newsletter/subscription-status.ts"),o=n("../shared-types/frontend/core/store.ts"),i=n("../../node_modules/js-cookie/src/js.cookie.js"),r=n.n(i),p=n("./src/ts/utils/inview.ts");const c=()=>!!r().get(s.y.SignedUp),l=({popupGateElement:e,clickedLink:t,store:n})=>{e.setAttribute("hidden","false"),e.setAttribute("data-popup-gate-newsletter-redirect-url",t.href),n.dispatch({type:o.U.TrackEvent,payload:{pev2:"newsletter popup gate displayed",events:["event113"]}})},a=({popupGateElement:e,clickedLink:t,store:n})=>{const s=document.querySelector("#inline-placement")||document.querySelector(".anyclip-placement");(null==s?void 0:s.childNodes.length)?(0,p.oO)({element:s,isNotInViewportCallback:()=>{l({clickedLink:t,popupGateElement:e,store:n})}}):l({clickedLink:t,popupGateElement:e,store:n})},d=(e,t,n=document)=>{const s=n.querySelector("#popup-gate-newsletter");return{init:()=>{if(c()||!s||!window.digitalMagazinePage)return{};const n=o=>{if(c())return void e.removeEventListener("click",n);const i=o.target.closest('a[href^="https://digitalarchive.timeout.com/"]');i&&(o.preventDefault(),a({clickedLink:i,popupGateElement:s,store:t}))};return e.addEventListener("click",n),{showPopup:n}}}},u=(e,t)=>{const n=Math.floor(1e4*Math.random());return{listeners:d(e,t).init(),componentId:"popup-gate-newsletter-cta-component-"+n}}},"./src/ts/utils/inview.ts":(e,t,n)=>{"use strict";n.d(t,{oe:()=>s,oO:()=>o,W0:()=>i});const s=e=>{if(!e)return!1;const t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,s=window.innerWidth||document.documentElement.clientWidth,o=t.top<=n&&t.top+t.height>=0,i=t.left<=s&&t.left+t.width>=0;return o&&i};function o({element:e,observerOptions:t={},isInViewportCallback:n,isNotInViewportCallback:s}){new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&n&&(s||t.unobserve(e.target),n(e)),!e.isIntersecting&&s&&(n||t.unobserve(e.target),s(e))})},t).observe(e)}function i(e,t){return e?new Promise(n=>{o({element:e,observerOptions:t,isInViewportCallback:n})}):Promise.reject()}},"../shared-types/frontend/components/newsletter/subscription-status.ts":(e,t,n)=>{"use strict";var s;n.d(t,{y:()=>s}),function(e){e.SignedUp="_TO_Newsletter_SignedUp",e.Dismissed="_TO_Newsletter_Dismissed",e.PageViewCount="_TO_Newsletter_PageViewCount"}(s||(s={}))}}]);