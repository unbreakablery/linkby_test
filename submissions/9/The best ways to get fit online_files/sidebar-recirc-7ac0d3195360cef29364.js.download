(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["sidebar-recirc"],{"./src/ts/components/recirc/sidebar-recirc.ts":(e,t,r)=>{"use strict";r.r(t),r.d(t,{SidebarRecirc:()=>u,init:()=>m});var i=r("../shared-types/frontend/core/store.ts"),n=r("../shared-types/frontend/utils/discover.ts"),s=r("./src/ts/core/client.ts"),o=r("./src/ts/utils/discover.ts"),c=r("./src/ts/utils/inview.ts"),a=r("./src/ts/utils/recirc.ts"),l=r("./src/ts/utils/request.ts");const d="to_recirc_visited_history",p=[{recircType:"popular",omnitureLoadedEvent:{events:["event229"],pev2:"recircloaded_rightrail_popular_5"},omnitureInViewEvent:{events:["event229"],pev2:"recircinview_rightrail_popular_5"},discoverTrackingUID:"recirc_rightrail_popular_5::",discoverFilters:[n.v.ORContentTypePost,n.v.ORContentTypePage,n.v.ORContentTypeVenue,n.v.ORContentTypeEvent,n.v.ANDCommercialFalse,n.v.ANDUpdatedAtGte2MAgo],discoverSorters:[n.R.PageViews24HDesc],size:5+(0,a.G4)(d).length},{recircType:"latestFilms",omnitureLoadedEvent:{events:["event229"],pev2:"recircloaded_rightrail_latestFilms_5"},omnitureInViewEvent:{events:["event229"],pev2:"recircinview_rightrail_latestFilms_5"},discoverTrackingUID:"recirc_rightrail_latestFilms_5::",discoverFilters:[n.v.ORContentTypePage,n.v.ORContentTypeFilm,n.v.ANDApplyStarRating],discoverSorters:[n.R.PublishedAtDesc],multiSearch:!0,size:3+(0,a.G4)(d).length,dataFilter:(e,t)=>{const r=[],i=[];e.forEach(e=>{"page"===e.type?r.push(e):i.push(e)});const n=Math.max(2,t-i.length);return r.slice(0,n).concat(i)}},{recircType:"popularFilms",omnitureLoadedEvent:{events:["event229"],pev2:"recircloaded_rightrail_popularmovies_5"},omnitureInViewEvent:{events:["event229"],pev2:"recircinview_rightrail_popularmovies_5"},discoverTrackingUID:"recirc_rightrail_popularmovies_5::",discoverFilters:[n.v.ORContentTypeFilm],discoverSorters:[n.R.PopularityDesc],size:5+(0,a.G4)(d).length}],u=()=>{const e={buildTemplate:(e,t,r)=>{const{wrap:i,template:n}=e;n&&i&&i.insertAdjacentHTML("beforeend",(0,o.Ec)({data:t,trackingUID:r,template:n.content,aspectRatio:"16-9"}))},render:(t,r,n,s,o)=>{const{meta:l,body:p}=null!=o?o:{};if(!l||!p)return;if(!p.length||p.length<2)return;const{hostUid:u,pageType:m}=r;(0,a.TG)(d,`Content-${m}-${u}`);const g=(0,a.mO)(5,(0,a.G4)(d),p,n.dataFilter);e.buildTemplate(t,g,n.discoverTrackingUID),t.content.classList.remove("hide"),s.dispatch({type:i.U.RecircSidebarLoaded,payload:n.omnitureLoadedEvent});const h="recirculation - [label]".replace(/\[label\]/g,t.heading.textContent.toLowerCase());return(0,c.W0)(t.rootElement).then(()=>{s.dispatch({type:i.U.DataLayerPush,payload:{action:"zone - recirc-sidebar",label:h,event:"in-view",category:"GP Impression"}})}),{}},getData:async(t,r,i,n)=>{var s;try{const{hostUid:c,pageType:a}=r,d=`Content-${a}-${c}`,p=await(0,l.A_)((0,o.fg)({uid:d,size:i.size,filters:i.discoverFilters,sorters:i.discoverSorters,multiSearch:null!==(s=i.multiSearch)&&void 0!==s&&s}));return e.render(t,r,i,n,p),p}catch(e){console.error(e)}},bindEvents:(t,r)=>{if(!1===window._TO.shouldLoadRecirc)return{};const n=(e=>{const{pageType:t,hostUid:r,recircType:i}=e.dataset;return{hostUid:r,recircType:i,type:null!=t?t:"",pageType:(null!=t?t:"").replace("listfeature","page").replace("package","page").replace(/^\w/,e=>e.toUpperCase())}})(t);if("post"===n.type&&"xs"===(0,s.iu)())return{};const o=p.find(e=>e.recircType===n.recircType);if(!o)return{};r.dispatch({type:i.U.RecircSidebarInview,payload:o.omnitureInViewEvent});const c=(e=>({rootElement:e,template:e.querySelector("template"),content:e.querySelector(".js_recirc_content"),wrap:e.querySelector(".js_recirc_list_items"),heading:e.querySelector(".js_heading")}))(t);return e.getData(c,n,o,r),{}}};return e},m=(e,t)=>{const r=Math.floor(1e4*Math.random());return{listeners:u().bindEvents(e,t),componentId:"sidebar-recirc-"+r}}},"./src/ts/config/config.ts":(e,t,r)=>{"use strict";r.d(t,{p:()=>s,u:()=>o});var i=r("./src/ts/utils/config-utils.ts");let n={};const s=()=>{const e=(0,i.P)(),t=e.site||"uk-london",[r,s]=t.split("-"),o=e.locale||"en-GB",c=e.currency_symbol||"Â£",a=e.current_commit||null,l=e.graffiti||null,d=e.discover||null,p=e.auth||null,u=e.pageUID||null;return n={...n,site:t,city:s,country:r,locale:o,currencySymbol:c,currentCommit:a,graffiti:l,discover:d,auth:p,pageUid:u},n},o=e=>{var t;return null!==(t=n[e])&&void 0!==t?t:null}},"./src/ts/core/client.ts":(e,t,r)=>{"use strict";r.d(t,{uj:()=>c,Ef:()=>l,iu:()=>d});var i=r("../shared-types/frontend/core/store.ts"),n=r("./src/ts/config/settings.ts");let s,o=!1;const c=()=>window.innerWidth>=window.innerHeight?"landscape":"portrait",a=e=>{const{client:{breakpoint:t}}=e.getState(),r=(({width:e,currentBreakpoint:t,breakpoints:r=n.aj})=>(Object.entries(r).some(([r,{min_width:i,max_width:n}])=>{const s={min:!1,max:!1};return(e>=i||0===i)&&(s.min=!0),(e<=n||0===n)&&(s.max=!0),!(!s.min||!s.max||r===t)&&(t=r,!0)}),t))({width:window.innerWidth,currentBreakpoint:t});t!==r&&e.dispatch({type:i.U.ClientBreakpoint,payload:{breakpoint:r}})},l=()=>{if(o)return;const e=window.gpStore;s=e,(e=>{const t=()=>{a(e)};window.matchMedia(`(min-width: ${n.aj.sm.min_width}px)`).addListener(t),window.matchMedia(`(min-width: ${n.aj.md.min_width}px)`).addListener(t),window.matchMedia(`(min-width: ${n.aj.lg.min_width}px)`).addListener(t)})(e),(e=>{a(e)})(e),o=!0},d=()=>s.getState().client.breakpoint},"./src/ts/utils/config-utils.ts":(e,t,r)=>{"use strict";r.d(t,{P:()=>i,R:()=>n});const i=()=>{const e={};return document.querySelectorAll("meta").forEach(t=>{const r=t.name?t.name:t.getAttribute("property")||!1;r&&(e[r]=t.content?t.content:t.dataset)}),e},n=(e=document)=>e.querySelector("body").dataset.pageType},"./src/ts/utils/inview.ts":(e,t,r)=>{"use strict";r.d(t,{oe:()=>i,oO:()=>n,W0:()=>s});const i=e=>{if(!e)return!1;const t=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,n=t.top<=r&&t.top+t.height>=0,s=t.left<=i&&t.left+t.width>=0;return n&&s};function n({element:e,observerOptions:t={},isInViewportCallback:r,isNotInViewportCallback:i}){new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&r&&(i||t.unobserve(e.target),r(e)),!e.isIntersecting&&i&&(r||t.unobserve(e.target),i(e))})},t).observe(e)}function s(e,t){return e?new Promise(r=>{n({element:e,observerOptions:t,isInViewportCallback:r})}):Promise.reject()}},"./src/ts/utils/recirc.ts":(e,t,r)=>{"use strict";r.d(t,{G4:()=>i,TG:()=>n,mO:()=>s});const i=(e="")=>window.sessionStorage&&window.sessionStorage.getItem(e)&&JSON.parse(window.sessionStorage.getItem(e))||[],n=(e="",t="")=>{if(!window.sessionStorage)return;const r=i(e);return r.includes(t)||(r.push(t),sessionStorage.setItem(e,JSON.stringify(r))),t},s=(e=0,t=[],r=[],i)=>{const n=r.filter(e=>!t.includes(e.uid)),s=i?i(n,e):n;return s.length>e?s.slice(0,e):s}},"./src/ts/utils/responsive-image.ts":(e,t,r)=>{"use strict";var i;r.d(t,{J:()=>s}),function(e){e["4-3"]="auto",e["16-9"]="auto"}(i||(i={}));const n={"4-3":[[380,285],[750,562],[1024,768],[1372,1029]],"16-9":[[400,225],[750,422],[1024,576],[1372,772]]},s=({pattern:e="{width}/{height}",aspectRatioKey:t="4-3",title:r="",alt:s="",imageClass:o=""})=>{const c=((e="{width}/{height}",t="4-3")=>n[t].map(t=>`${e.replace("{width}",t[0].toString()).replace("{height}",t[1].toString())} ${t[0]}w`).join(","))(e,t),[,[a,l]]=n[t];return`<img\n        src="${e.replace("{width}",""+a).replace("{height}",""+l)}"\n        srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="\n        data-sizes="${i[t]}"\n        data-srcset="${c}"\n        class="lazyload ${o} aspect-ratio-${t}"\n        title="${r}"\n        alt="${s}"\n    />`}}}]);